---
output:
  bookdown::pdf_document2: 
    toc: FALSE
fontsize: 12pt
header-includes:
  - \usepackage{xcolor}
  - \usepackage{float}
  - \usepackage{tabu}
  - \usepackage{multirow}
  - \usepackage{colortbl}
params:
  current.year: 2017
  dp.text: 1
  dp.tables: 2
bibliography: wales.bib
csl: apa-with-notes.csl
---
  
```{r, echo = FALSE}
report.name <- paste0("wales-report-", params$current.year, "-",
                      params$current.year - 1999)
bib <- readRDS(here::here(paste0("data/03-processed/", report.name, "-bib.rds")))
```

---
title: "`r paste("Local Authority Parking Finances in Wales", params$current.year, "-", params$current.year-1999)`"
nocite: |
  `r paste0(bib$refs, collapse = ", ")`
---
  
```{r setup, echo = FALSE, warning = FALSE, message = FALSE}
source(here::here("code/wales.R"))
```
\renewcommand{\arraystretch}{1.2}

# Introduction

This note covers parking finances for the 22 local authorities in Wales. As in England and Scotland, local authorities are required to submit details of all their finances to the Welsh Government in a standard format. They are normally published in October, seven months after the financial year end. This report looks at the section on parking income and expenditure from `r FunFisc(4)` to `r FunFisc()` and is based primarily on data reported by Statistics for Wales (`r bib[bib$country == "Wales",]$refs`), as well as data reported by English and Scotish Local Government authorities, all of the sources of which care listed in the references.[^1]

[^1]: Contains public sector information licensed under the [Open Government Licence v3.0](http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/). 


The published data is less comprehensive than in England and does not split out on- and off-street parking or show penalty income separately. The figures do not include any commercial off-street parking. In `r FunFisc()`, `r FunN2W(surplus.bin[2])` councils showed surpluses and `r FunN2W(surplus.bin[1])` showed deficits \color{red}(the same three councils as `r FunFisc(1)`). \color{black} All councils are now receiving income from parking, \color{red} although councils such as Blaenau Gwent (Ebbw Vale and Abertillery) and Torfaen (Pontypool and Cwmbran) offer free parking but still issue penalty charge notices. \color{black}

# Summary

```{r summary, echo = FALSE, message = FALSE, warning = FALSE}
# print summary table
wal.summary.formatted %>% 
  kable( "latex", 
         booktabs = T, 
         digits = 2, 
         longtable = TRUE,
         escape = F,
         align = c("r"),
         caption = "Summary of parking accounts for Wales (£ millions)",
         col.names = c("", "", yearz, paste0("Change ", current.year, "-", 
                                             current.year-1999, " on ", 
                                             current.year-1, "-", 
                                             current.year-1999-1))) %>% 
  collapse_rows(columns = 1, latex_hline = "major", valign = "middle") %>% 
  kable_styling(full_width = TRUE, 
                latex_options =c("HOLD_position", "striped"), 
                font_size = 10) %>% 
  column_spec(1:2, width = "3cm") 
```

Table \@ref(tab:summary) shows the summary accounts for local authorities in Wales of the incomes and expenditures arising from parking charges and penalty income both for on- and off-street parking. The income has 
`r ifelse(wal.summary$change[1] < -0.05, paste("fallen by", FunDec(-wal.summary$change[1], dp.text), "%"), ifelse(wal.summary$change[1] > 0.05, paste("increased by", FunDec(wal.summary$change[1], dp.text), "%"),"stayed approximately the same"))`, the expenditure has 
`r ifelse(wal.summary$change[2] < -0.05, paste("fallen by", FunDec(-wal.summary$change[2], dp.text), "%"), ifelse(wal.summary$change[1] > 0.05, paste("increased by", FunDec(wal.summary$change[2], dp.text), "%"),"stayed approximately the same"))` and the surplus has
`r ifelse(wal.summary$change[3] < -0.05, paste("fallen by", FunDec(-wal.summary$change[3], dp.text), "%"), ifelse(wal.summary$change[1] > 0.05, paste("increased by", FunDec(wal.summary$change[3], dp.text), "%"),"stayed approximately the same"))`
compared to the previous fiscal year. Total transport has
`r ifelse(wal.summary$change[4] < -0.05, paste("fallen by", FunDec(-wal.summary$change[4], dp.text), "%"), ifelse(wal.summary$change[1] > 0.05, paste("increased by", FunDec(wal.summary$change[4], dp.text), "%"),"stayed approximately the same"))` and the surplus now represents 
`r paste(FunDec(wal.summary[5, 6], dp.text), "%")` of transport costs. 

Parking makes a 
`r ifelse(wal.summary[5, 6] < eng.trans - 0.05 , "smaller", ifelse(wal.summary[5, 6] > eng.trans + 0.05,  "larger","similar"))` contribution to overall transport expenditure in Wales compared with England where it is around `r FunDec(eng.trans, dp.text)` % of total transport. 
Since `r FunFisc(4)` income has `r ifelse(wal.summary[1,6] > wal.summary[1,2], "risen", "fallen")` by 
`r FunDec(100*wal.summary[1,6]/wal.summary[1,2] - 100, dp.text)` % and expenditure has `r ifelse(wal.summary[2,6] > wal.summary[2,2], "risen", "fallen")` by `r FunDec(100*wal.summary[2,6]/wal.summary[2,2] - 100, dp.text)` %. Over the same period the surplus has `r ifelse(wal.summary[3,6] > wal.summary[3,2], "risen", "fallen")` by `r FunDec(100*wal.summary[3,6]/wal.summary[3,2] - 100, dp.text)` %. Figure \@ref(fig:fig1) gives a longer term overview of the trends in incomes, expenditures and surpluses. 

```{r fig1, echo = FALSE, fig.cap = "Parking revenues--Wales", fig.showtext=TRUE,}
# plot summary trend chart
old.par <- par(mar = c(5.1, 4.1, 3.1, 2.1))
plot(data.plot$year, data.plot$income.total, 
     ylim = c(0, max(data.plot$income.total)), 
     type = "l",
     lwd = 2,
     col = viridis(3)[1],
     bty = "n",
     xlab = "Fiscal Year",
     ylab = "£ (millions)",
     axes = FALSE, family = "meri", cex.lab = 0.8)
axis(1, at = data.plot$year, 
     labels = rep("", length(data.plot$year),
                  family = "meri", cex.axis = 0.6, las = 2, srt = 45))
text(data.plot$year, par("usr")[3] - 0.5, 
     labels = paste0(data.plot$year, "-", data.plot$year-1999), 
     srt = 45, adj = c(1.2,1.5), xpd = TRUE, family = "meri", cex = 0.6)
axis(2, las = 2, family = "meri", cex.axis = 0.6 )
grid(nx = NA, ny = NULL, lty = "93")
lines(data.plot$year, data.plot$expend.total, 
      ylim = c(0, max(data.plot$expend.total)), 
      type = "l",
      lwd = 2,
      col = viridis(3)[2])
lines(data.plot$year, data.plot$surplus.total, 
      ylim = c(0, max(data.plot$surplus.total)), 
      type = "l",
      lwd = 2,
      col = viridis(3)[3])
par(family = "meri")
legend("topleft",
       legend = c("Income", "Expenditure", "Surplus"),
       bty = "n",
       col = viridis(3), 
       lwd = 2, cex = 0.8, xpd= TRUE)
par(old.par)
```

```{r compare, echo = FALSE}
# print comparison between countries table
sum.gb.formatted %>% 
  kable( "latex", 
         booktabs = T, 
         digits = c(rep(0, 6), 2), 
         escape = F,
         longtable = T,
         align = c("r"),
         col.names = c("", "England without London", "London", 
                       "Scotland", "Wales", "Great Britain"),
         caption = paste0("Comparison of parking income and expenditure in across the nations of Great Britain (£ millions)"), 
         format.args = list(big.mark = ","),
         linesep = "") %>% 
  kable_styling(full_width = TRUE, 
                latex_options =c("HOLD_position", "striped", "repeat_header"), 
                font_size = 10) %>% 
  column_spec(1, width = "5cm") %>% 
  row_spec(c(1, 4), hline_after = TRUE)
```


\pagebreak

Table \@ref(tab:compare) provides a comparison with London, England excluding London, and Wales for  for the most recent available data, while Table \@ref(tab:annual) shows the annual change over the years `r FunFisc(current.year-ref.year)` and `r FunFisc()`. 

On average, parking surpluses in Great Britain have risen by about `r FunDec(sum.gb.annual$surplus.change[sum.gb.annual$country == "Great Britain"], dp.text)` % annually over the past `r FunN2W(current.year - ref.year)` years compared with `r FunDec(rpi.annual, dp.text)` % annually for the Retail Prices Index during the same period (`r sco.bib.rpi`). 


```{r annual}
# print table comparing annual changes over last 5 years. 
sum.gb.annual.tab.formatted %>% 
  kable( "latex", 
         booktabs = T, 
         digits = c(rep(0, 6), 2), 
         escape = F,
         longtable = TRUE,
         align = c("r"),
         col.names = c("",  "England without London", "London", 
                       "Scotland", "Wales", "Great Britain"),
         caption = paste0("Annual changes in parking income and expenditure from ", FunFisc(current.year - ref.year), " to ", FunFisc(), " across the nations of Great Britain"), 
         format.args = list(big.mark = ","),
         linesep = "") %>% 
  kable_styling(full_width = TRUE, 
                latex_options =c("HOLD_position", "striped", "repeat_header"), 
                font_size = 10) %>% 
  column_spec(1, width = "5cm") %>% 
  column_spec(6, width = "3cm")
```

\pagebreak

# Income

Total council parking income from all sources in `r FunFisc()` was £`r FunDec(wal.summary[1, 6], dp.text)` million, `r FunDec(wal.summary$change[1], dp.text)` % `r ifelse (wal.summary$change[1] > 0, "higher", "lower")` than `r FunFisc(1)`. Note that this includes penalty income, which is not shown separately, but does not include off-street income received by commercial off-street parking facilities. Table \@ref(tab:income) ranks the Welsh councils in terms of parking income. 

`r FunFirstup(FunN2W(income.bin[2]))` councils increased their income over the past year and `r FunN2W(income.bin[1])` decreased their income. `r if (wal.no.income > 0 ) {paste0(" ", FunFirstup(FunN2W(wal.no.income)), " councils did not show any income in ", FunFisc(), ".")}` The changes from `r FunFisc(1)` are mapped[^2] in Figure \@ref(fig:mapincome).

[^2]:  Boundary data for this and all further maps is from `r wal.bib.map`. Contains public sector information licensed under the [Open Government Licence v3.0.](http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/)

```{r mapincome, fig.cap = "Map of change in parking income since previous fiscal year", fig.pos="H"}
# map income change
FunMap(wal.income, uc, country = "^W",  dir = 1)
```

The top three Welsh councils by income were `r paste0(names(wal.income.top3)[1], ", ", names(wal.income.top3)[2], ", and ", names(wal.income.top3)[3])`, and between them accounted for `r FunDec(wal.income.top3[1], dp.text)` % of parking income.

`r wal.income.change.top3[1,2]` increased their income by `r FunDec(wal.income.change.top3$change[1], dp.text)` %
while `r wal.income.change.top3[2,2]` and `r wal.income.change.top3[3,2]` increased  by `r FunDec(wal.income.change.top3$change[2], dp.text)` % and `r FunDec(wal.income.change.top3$change[3], dp.text)` % respectively`r if(nrow(wal.income.excluded.top) > 0) paste0(" (excluding ", FunMultiText(wal.income.excluded.top$auth.name), " with income under £30,000)")`. The biggest decreases were in `r wal.income.change.bottom2[2,2]` (`r FunDec(abs(wal.income.change.bottom2$change[2]), dp.text)` %), and `r wal.income.change.bottom2[1,2]` (`r FunDec(abs(wal.income.change.bottom2$change[1]), dp.text)`  %)`r if(nrow(wal.income.excluded.bottom) > 0) paste0(" (excluding ", FunMultiText(wal.income.excluded.bottom$auth.name), " with income under £30,000)")`.



```{r income, echo = FALSE, message = FALSE, warning = FALSE}
# pring income table 
wal.income.formatted %>%  
  kable( "latex", 
         booktabs = T, 
         digits = c(rep(0, 6), 2), 
         escape = F,
         longtable = TRUE,
         align = c("r"),
         caption = "Parking income for Wales (£,000)",
         format.args = list(big.mark = ","),
         linesep = "",
         col.names = c("\\multirow{1}{*}[0pt]{Local Authority}", yearz, paste0("Change ", current.year, "-", current.year-1999, " on ", current.year-1, "-", current.year-1999-1))) %>% 
  kable_styling(full_width = TRUE, 
                latex_options =c("HOLD_position", "striped", "repeat_header"), 
                font_size = 10) %>% 
  column_spec(1, width = "4cm") %>% 
  row_spec(22, hline_after = TRUE)

```


\pagebreak 

# Expenditure

Table \@ref(tab:expenditure) ranks the councils in terms of expenditure on parking.

Overall expenditure has `r ifelse( wal.expend.t[2] > 0, "risen", "fallen")` by £`r FunDec(abs(wal.expend.t[2]), dp.text)` million (`r FunDec(abs(wal.expend.t[1]), dp.text)` %) after a `r ifelse( wal.expend.t[3] > 0, paste0("rise of £", FunDec(wal.expend.t[3], dp.text), " million last year"), paste0("fall of £", FunDec(abs(wal.expend.t[3]), dp.text), "m last year"))`, with `r FunN2W(expend.bin[2])` councils having increased their costs and `r FunN2W(expend.bin[1])` having reduced their costs. The changes from `r FunFisc(1)` are mapped in Figure \@ref(fig:mapexpend).

The largest increase in expenditure occured in `r wal.expend.change.top3[1,2]` where it increased by `r FunDec(wal.expend.change.top3$change[1], dp.text)` %
while `r wal.expend.change.top3[2,2]` and `r wal.expend.change.top3[3,2]` increased  by `r FunDec(wal.expend.change.top3$change[2], dp.text)` % and `r FunDec(wal.expend.change.top3$change[3], dp.text)` % respectively`r if(nrow(wal.expend.excluded.top) > 0) paste0(" (excluding ", FunMultiText(wal.expend.excluded.top$auth.name), " with expenditure under £30,000)")`. The biggest decreases were in `r wal.expend.change.bottom2[2,2]` (`r FunDec(abs(wal.expend.change.bottom2$change[2]), dp.text)` %), and `r wal.expend.change.bottom2[1,2]` (`r FunDec(abs(wal.expend.change.bottom2$change[1]), dp.text)`  %)`r if(nrow(wal.expend.excluded.bottom) > 0) paste0(" (excluding ", FunMultiText(wal.expend.excluded.bottom$auth.name), " with expenditure under £30,000)")`.

The table also shows the proportion of income taken up by costs in `r FunFisc()`. Nationally in Wales it is `r FunDec(wal.expend.p[2], dp.text)` % with Cardiff at `r FunDec(wal.expend.p[1], dp.text)` %.

```{r expenditure, echo = FALSE, message = FALSE, warning = FALSE}

wal.expend.formatted %>% 
  kable( "latex", 
         booktabs = T, 
         digits = 0, 
         escape = F,
         longtable = TRUE,
         align = c("r"),
         caption = "Parking expenditure for Wales (£,000)",
         format.args = list(big.mark = ","),
         linesep = "",
         col.names = c("\\multirow{1}{*}[0pt]{Local Authority}", yearz, 
                       paste0("Change ", current.year, "-", current.year-1999, 
                              " on ", current.year-1, "-", current.year-1999-1), "Expenditure as proportion of income")) %>% 
  kable_styling(full_width = TRUE, 
                latex_options =c("HOLD_position", "striped", "repeat_header"), 
                font_size = 10) %>% 
  column_spec(1, width = "3.3cm") %>% 
  column_spec(8, width = "1.8cm") %>% 
  row_spec(22, hline_after = TRUE)
```


```{r mapexpend, fig.cap = "Map of change in parking expenditure since previous fiscal year", fig.pos="H"}
# map change in expenditure
FunMap(wal.expend, uc, country = "^W",  dir = -1)
```

Table \@ref(tab:propexpend) shows the proportion of income taken up by expenditure. Across Wales it was `r FunDec(wal.expend.of.income[23,6], dp.text)` % compared to `r FunDec(wal.expend.of.income[23,5], dp.text)` % in the previous year, suggesting `r ifelse(wal.expend.of.income[23,6] < wal.expend.of.income[23,5], "improving", "declining")` efficiency in operations. 

Cardiff’s expenditure was `r FunDec(wal.expend.of.income[wal.expend.of.income$auth.name == "Cardiff",6], dp.text)` % of its income having `r ifelse(wal.expend.of.income[wal.expend.of.income$auth.name == "Cardiff",6] < wal.expend.of.income[wal.expend.of.income$auth.name == "Cardiff",5], "fallen", "risen")` since last year, while Swansea's has `r ifelse(wal.expend.of.income[wal.expend.of.income$auth.name == "Swansea",6] < wal.expend.of.income[wal.expend.of.income$auth.name == "Swansea",5], "fallen", "risen")` to `r FunDec(wal.expend.of.income[wal.expend.of.income$auth.name == "Swansea",6], dp.text)` %.

\color{red} Most of the medium-sized councils spend 50–90% of their income on parking management, which includes enforcement. \color{black} Care should be taken in interpreting the percentages towards the bottom of the table, as the very low parking incomes can lead to extreme values which are less meaningful.  

```{r propexpend}
# print table of expenditures as proportion of income. 
wal.expend.of.income.formatted %>% 
  kable( "latex", 
         booktabs = TRUE, 
         digits = 0, 
         escape = FALSE,
         longtable = TRUE,
         align = c("r"),
         caption = "Parking expenditure for as proportion of parking income",
         format.args = list(big.mark = ","),
         linesep = "",
         col.names = c("\\multirow{1}{*}[0pt]{Local Authority}", yearz)) %>% 
  kable_styling(full_width = TRUE, 
                latex_options =c("HOLD_position", "striped", "repeat_header"), 
                font_size = 10) %>% 
  column_spec(1, width = "3.7cm") %>% 
  row_spec(22, hline_after = TRUE) %>% 
  footnote(symbol = "Empty cells indicate the council reported no income and/or no expenditure")

```

\pagebreak

# Surpluses

Table \@ref(tab:surplustab) shows the parking surpluses from from `r FunFisc(4)` to `r FunFisc()` and the change from `r FunFisc(1)` to `r FunFisc()`. It also shows the proportion that parking surpluses represent of total transport expenditure.

The total *surpluses* for Wales amounted to £`r FunDec((wal.surplus.totals.table[24, 6]/1000), dp.text)` million between `r  wal.poz.surplus ` authorities of which `r paste0(names(wal.surplus.top3)[1], ", ", names(wal.surplus.top3)[2], ", and ", names(wal.surplus.top3)[3])` contributed `r  FunDec(wal.surplus.top3[1], dp.text)`%. `r FunFirstup(FunN2W(surplus.bin[1]))` councils made a loss with the total of parking deficits `r ifelse(wal.surplus.totals.table[23,6] > wal.surplus.totals.table[23,5], "falling", "rising")` to £`r FunDec(-wal.surplus.totals.table[23,6]/1000, dp.text)` million from £`r FunDec(-wal.surplus.totals.table[23,5]/1000, dp.text)` million last year.

Overall, parking contributed £`r FunDec((wal.surplus.totals.table[25, 6]/1000), dp.text)` million to local authority finances in Wales in `r FunFisc()` compared with £`r FunDec((wal.surplus.totals.table[25, 5]/1000), dp.text)` million in `r FunFisc()`, an increase of `r FunDec((wal.surplus.totals.table[25, 7]), dp.text)` %. 

`r wal.surplus.change.top3[1,2]` increased their surplus by `r FunDec(wal.surplus.change.top3$change[1], dp.text)` %
while `r wal.surplus.change.top3[2,2]` and `r wal.surplus.change.top3[3,2]` increased  by `r FunDec(wal.surplus.change.top3$change[2], dp.text)` % and `r FunDec(wal.surplus.change.top3$change[3], dp.text)` % respectively`r if(nrow(wal.surplus.excluded.top) > 0) paste0(" (excluding ", FunMultiText(wal.surplus.excluded.top$auth.name), " with a surplus/deficit under £30,000)")`. The biggest decreases were in `r wal.surplus.change.bottom2[2,2]` (`r FunDec(abs(wal.surplus.change.bottom2$change[2]), dp.text)` %), and `r wal.surplus.change.bottom2[1,2]` (`r FunDec(abs(wal.surplus.change.bottom2$change[1]), dp.text)`  %)`r if(nrow(wal.surplus.excluded.bottom) > 0) paste0(" (excluding ", FunMultiText(wal.surplus.excluded.bottom$auth.name), " with a surplus/deficit under £30,000)")`.


```{r surplustab}
# print surplus table
wal.surplus.formatted %>% 
  kable( "latex", 
         booktabs = TRUE, 
         digits = 0, 
         escape = FALSE,
         longtable = TRUE,
         align = c("r"),
         caption = "Parking surpluses for Wales (£,000)",
         format.args = list(big.mark = ","),
         linesep = "",
         col.names = c("\\multirow{1}{*}[0pt]{Local Authority}", yearz, 
                       paste0("Change ", current.year, "-", current.year-1999, 
                              " on ", current.year-1, "-", current.year-1999-1), "Surplus as proportion of transport spending")) %>% 
  kable_styling(full_width = TRUE, 
                latex_options =c("HOLD_position", "striped", "repeat_headers"), 
                font_size = 10) %>% 
  column_spec(1, width = "3.3cm") %>% 
  row_spec(c(22, 24), hline_after = TRUE) %>% 
  footnote(symbol = "Where the change in surplus is actually a change in deficit, the values are in italics")

```


## References {-}

