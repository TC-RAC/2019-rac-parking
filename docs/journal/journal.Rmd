---
title: "Analysis Journal---RAC Parking Report Automation"
author: mz
output:
  pdf_document: default
---

# Saturday 9.3.2019

* Initialised public github repo.

* Setup folder structure, currenlty looks like this (output of `tree --charset=ascii -d`):
```
|-- code
|-- data
|   |-- 01-raw
|   |-- 02-interim
|   `-- 03-processed
|-- docs
|   |-- admin
|   |-- journal
|   `-- original-reports
|-- figures
`-- outputs
    |-- instructions
    |-- reports
    `-- technical-appendix
```

* available reports used for development, downloaded from RAC press website, pdfs stored in `/docs/original-reports`, see appendix for full table

Next steps: find data

# Thursday 14.3.2019

* Look through back reports available, saving all and saving links here, in appendix 1

* Start query file for Ivo. 

* OK, got all reports, despite missing years, it looks like most of the data is included in other reports as they have a window of usually 4 years previous that they include data for. 

* Now figure out data sources for England, and detail them 

* Outline typical England report

## England data requirements and availability?

* 2017/18 uses "MHCLG tables on parking income and expenditure"

This looks like the data [https://www.gov.uk/government/collections/local-authority-revenue-expenditure-and-financing](here). 

* For each year there is normally budget, provisional outturn and outturn data, the latter needs to be for individual local authorities, which does not seem to exist for 2007/08, but is available for all other years. 
* The files are grouped under the title *Local authority revenue expenditure and financing England: 2010 to 2011 individual local authority data - outturn* for each year
* The relevant Excel file is usually called `Revenue outturn RO2 (highways and transport services) + year.xls`.
* There are three columns we are interested in: expenditures, incomes and capital charges, these are usually on separate sheets. There is one of these for both on street and off street parking. So that's 6 columns in total.
* There are also summaries, but I don't need them, maybe only for manually double-checking.
* Appendix 2 lists all the files, their links, the number or rows (local authorities) in the table and the sheets on which the data can be found.
* TODO Add the starting row and the actual columns where the data in question can be found and I can write a funciton to extract the data automatically. 
* Download all `.xls` files to `/data/raw`

* "Earlier, councils also submitted budgets for the 2018-19financial year but on a less detailed basis." where are these budgets? Do I need to include them as well? Ah, yes.

* At one point the England data stops including capital charges..2013/14 is last one. This means current reports are less data rich, and if I stick to the brief, it means that the code won't be able to replicate the old reports. 
* At one point the Englad data starts including penalty charges for individual Local authorities, although the reports don't do anything special with that, just use the aggregates 

* England totals do not include the national parks and the Nottingham levy. Not sure what to do with that!?

# Friday 15.3.2019

* OK, so England outturn data is tabled in Appendix 2.
* Now England Budget data
  + not in *Local authority revenue expenditure and financing tables*
  + under *Budget estimates of local authority revenue expenditure and financing for the financial year* the table *Revenue account budget (RA)* has the parking surplus down as 792, but the report says 782. There have been a few other differnces, not sure if these are typos/errors?
  
* download data into `\data\raw` and fill out appendix two table with relevant info. 
* careful because at one point there are capital charges and then not. So make sure you've got the correct column. Because these are sums, I would even set up a check?
* OK, England budget files are all saved and relevant info extracted manually. 
* Now back to outlining the England report as it stands.
* E17/18 says national park surplus is 1.7 million, sum of cells DF405:411 is 1.774. 
* Comparing Table 1 for E17/18 to excel file:
  + on street parking is all the same
  + off street parking: there is a discrepancy. Income is the same, but Leibling's expenditure value is higher than the Excel one (making the surplus lower): 362 vs 356?! 


### England

#### 1. Introduction

* Mainly pure text chunk.
* Available data: fisc.year
* Missing data: national parks, Notthingham workplace parking levy? (17/18)

#### 2. Summary

##### Table 1 - Parking income and expenditure England

* Unit: whole country
* Available data:
  + Off-street: expenditures (sum from LA tables)
  + Off-street: incomes (sum from LA tables)
  + On-street: expenditures (sum from LA tables)
  + On-street: incomes (sum from LA tables)
  + On-street: penalties - single cell on summary sheet
  + Net expenditure on transport - single cell on summary sheet
  + Budget estimates for next year
* That's all, everything else is calculated from this





##### Text

* Conditional tree based on data from Table 1. 

##### Figure 1

* Simple line chart based on data from Table 1.

##### Table 2

* Data from Table 1 for current year, split by London and non-London. 

##### Text

* Conditional tree based on data from Table 2.

#### 3. Income

##### Text

* Conditional tree based on data from Tables 1 and 2
* Includes footnote on penalty tarrifs. 

#### 4. Expenditure

##### Text

* Conditional tree based on data from Tables 1 and 2

#### 5. Surpluses

##### Text

* Conditional tree based on data from Tables 1 and 2
* Additionally there is the total for on national parks, that data is also available
* Missing data: the total for Nottingham workplace levy. 






* link [https://www2.gov.scot/Topics/Statistics/Browse/Local-Government-Finance/PubScottishLGFStats](Scotland)


* link [https://statswales.gov.wales/Catalogue/Local-Government/Finance/Revenue/Transport/RoadsAndTransportRevenueExpenditure-by-authority](Wales:)



# Appendix 1
## links to all reports online
```{r appendix, child = 'app1.Rmd'}
```

# Appendix 2
## data overview 
```{r appendix, child = 'app2.Rmd'}
```